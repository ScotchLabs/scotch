<%= render "shared/inventory_form" %>
<article>
  <h1><%= @item %></h1>
  <p>
    <b>Catalog Number:</b>
    <%= @item.catalog_number %>
  </p>

  <p>
    <b>Location:</b>
    <%= @item.location %>
  </p>

  <p>
    <b>Item category:</b>
    <%= link_to @item.item_category.parent_category, @item.item_category.parent_category %> &mdash; <%= link_to @item.item_category, @item.item_category %><!-- #TODO FIXME there must be a prettier way to do this -->
  </p>

  <p>
    <b>Description:</b>
    <%= @item.description %>
  </p>

  <h2>Actions</h2>
  <p>
  <%= link_to 'Edit Item', edit_item_path(@item) %><br>
  <% if @item.available? and (has_permission? "checkoutSelf" or has_permission? "checkoutOther")-%>
    <%= link_to 'Check Out', new_item_checkout_path(@item) -%>
  <% elsif @item.available? %>
    Sorry, you don't have permission to check this item out.
  <% else %>
    This item is currently checked out to <%= link_to @item.current_checkout.user, @item.current_checkout.user %> for <%= link_to @item.current_checkout.group, @item.current_checkout.group %>. <!-- #TODO FIXME there must be a prettier way to do this -->
    <% if @item.current_checkout.has_deadline? %>Due back on <%= format_date @item.current_checkout.deadline %>.<% end %>
    <%= link_to "View Checkout", @item.current_checkout %>
  <% end %>
  </p>
</article>
<article>
  <h1>Recent Checkouts</h1>
  <p>
  <% if @checkouts.empty? %>
  No checkouts here!
  <% else %>
  <% @checkouts.each do |checkout| %>
  <%= link_to checkout.opener, checkout.opener %> checked it out
  <% if checkout.opener != checkout.user %>
    to <%= link_to checkout.user, checkout.user %> 
  <% end %>for
  <%= link_to checkout.group, checkout.group %> on <!-- #TODO FIXME there must be a prettier way to do this -->
  <%= format_time checkout.created_at %>. <%= link_to "View Checkout", @item.current_checkout %><br>
  <% end %>
  <p><%= link_to 'View All Checkouts', item_checkouts_path(@item) %></p>
  <% end %>
  </p>
</article>
