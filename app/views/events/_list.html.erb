<%
dates = Array.new
squish_events(events) do |es| %>
  <div class='event-list'>
  <% if not dates.include? es[0].start_time.strftime("%D")
    dates.push es[0].start_time.strftime("%D")
    day = es[0].start_time.day
    month = es[0].start_time.strftime("%b") %>
    <div class='event-badge'>
      <div class='event-badge-month'><%= month %></div>
      <div class='event-badge-day'><%= day %></div>
    </div>
  <% else %>
    <div class='event-badge-blank'></div>
  <% end %>
  <div class='event-info'>
  <% if es.length == 1
    e = es[0] %>
    <!-- Standard Event -->
    <h3><%= link_to e, "#show#{e.id}", :onclick => "showEvent(cachedEvents[#{e.id}])" %></h3> &mdash; <%= e.location %>
    <ul><li id='event-<%= e.id %>'><%= format_time(e.start_time) %> to <%= format_time(e.end_time) %>.<% # N attendees / Full. RSVP?
    %></li></ul>
  <% else %>
    <!-- Multi-Part Event -->
    <h3><%= es[0].title %></h3> &mdash; <%= es[0].location %>
    <ul>
      <% es.each do |e| %>
        <li id='event-<%= e.id %>'><%= link_to(format_time(e.start_time)+" to "+format_time(e.end_time), "#show#{e.id}", :onclick=>"showEvent(cachedEvents[#{e.id}])") %>.<% # N attendees / Full. RSVP?
        %></li>
      <% end %>
    </ul>
  <% end %>
  </div>
  </div>
<% end %>
